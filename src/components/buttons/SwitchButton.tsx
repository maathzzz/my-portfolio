import React, { use, useEffect } from "react";
import { useState } from "react";
import { motion } from "framer-motion";
import { useTheme } from "next-themes";

/**
 * This is an example of layout animations in Framer Motion 2.
 *
 * It's as simple as adding a `layout` prop to the `motion.div`. When
 * the flexbox changes, the handle smoothly animates between layouts.
 *
 * Try adding whileHover={{ scale: 1.2 }} to the handle - the layout
 * animation is now fully compatible with user-set transforms.
 */

export default function SwitchButton({ className }: any) {
    const { theme, setTheme } = useTheme();
    const [isOn, setIsOn] = useState(false);
    const [justifyClass, setJustifyClass] = useState("justify-start");

    const toggleSwitch = () => setIsOn(!isOn);

    const switchTheme = () => {
        setTheme(theme === "dark" ? "light" : "dark");
        setIsOn(!isOn);
        localStorage.setItem("theme", theme === "dark" ? "light" : "dark");
    }

    useEffect(() => {
        localStorage.getItem("theme") === "dark" ? setIsOn(false) : setIsOn(true);
        console.log(theme)
    }, [theme]);

    useEffect(() => {
        if (isOn) {
            setJustifyClass("justify-end");
        } else {
            setJustifyClass("justify-start");
        }
    }, [isOn])

    return (
        <button className={`w-[40px] h-[22px] bg-gray-300 opacity-50 flex ${justifyClass} items-center duration-200 rounded-[50px] p-[4px] cursor-pointer ${className}`} data-isOn={isOn} onClick={switchTheme}>
            <motion.div className={`w-[18px] h-[18px] rounded-full ${isOn ? 'bg-white' : 'bg-[#141414]'} flex justify-center items-center`} layout transition={spring}>

                {isOn ? (
                    <svg width="12" height="13" viewBox="0 0 12 13" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M6.00288 3.22656C6.65032 3.22656 7.28321 3.41855 7.82153 3.77824C8.35985 4.13794 8.77942 4.64919 9.02719 5.24734C9.27495 5.84549 9.33977 6.50367 9.21347 7.13867C9.08716 7.77366 8.77539 8.35694 8.31759 8.81474C7.85978 9.27255 7.2765 9.58432 6.64151 9.71063C6.00652 9.83693 5.34833 9.77211 4.75018 9.52435C4.15203 9.27658 3.64078 8.85701 3.28108 8.31869C2.92139 7.78037 2.7294 7.14748 2.7294 6.50004C2.73027 5.63213 3.07543 4.80001 3.68914 4.1863C4.30285 3.57259 5.13497 3.22743 6.00288 3.22656ZM6.00288 8.68236C6.43451 8.68236 6.85644 8.55437 7.21532 8.31458C7.5742 8.07478 7.85391 7.73395 8.01909 7.33518C8.18426 6.93641 8.22748 6.49762 8.14327 6.07429C8.05907 5.65097 7.85122 5.26211 7.54602 4.95691C7.24082 4.65171 6.85196 4.44386 6.42863 4.35966C6.00531 4.27545 5.56651 4.31867 5.16775 4.48384C4.76898 4.64902 4.42815 4.92873 4.18835 5.28761C3.94855 5.64649 3.82056 6.06842 3.82056 6.50004C3.82056 7.07883 4.05049 7.63391 4.45975 8.04318C4.86901 8.45244 5.4241 8.68236 6.00288 8.68236Z" fill="#141414" />
                        <path d="M6.00325 2.68232C5.85855 2.68232 5.71978 2.62484 5.61746 2.52252C5.51515 2.42021 5.45767 2.28144 5.45767 2.13674V1.04558C5.45767 0.900883 5.51515 0.762113 5.61746 0.659797C5.71978 0.557481 5.85855 0.5 6.00325 0.5C6.14794 0.5 6.28672 0.557481 6.38903 0.659797C6.49135 0.762113 6.54883 0.900883 6.54883 1.04558V2.13674C6.54883 2.28144 6.49135 2.42021 6.38903 2.52252C6.28672 2.62484 6.14794 2.68232 6.00325 2.68232Z" fill="#141414" />
                        <path d="M6.00227 10.3164C6.14697 10.3164 6.28574 10.3739 6.38805 10.4762C6.49037 10.5785 6.54785 10.7173 6.54785 10.862V11.9531C6.54785 12.0978 6.49037 12.2366 6.38805 12.3389C6.28574 12.4412 6.14697 12.4987 6.00227 12.4987C5.85757 12.4987 5.7188 12.4412 5.61649 12.3389C5.51417 12.2366 5.45669 12.0978 5.45669 11.9531V10.862C5.45669 10.7173 5.51417 10.5785 5.61649 10.4762C5.7188 10.3739 5.85757 10.3164 6.00227 10.3164Z" fill="#141414" />
                        <path d="M9.82158 6.49871C9.82158 6.35401 9.87907 6.21524 9.98138 6.11292C10.0837 6.01061 10.2225 5.95312 10.3672 5.95312H11.4583C11.603 5.95312 11.7418 6.01061 11.8441 6.11292C11.9464 6.21524 12.0039 6.35401 12.0039 6.49871C12.0039 6.6434 11.9464 6.78217 11.8441 6.88449C11.7418 6.9868 11.603 7.04429 11.4583 7.04429H10.3672C10.2225 7.04429 10.0837 6.9868 9.98138 6.88449C9.87907 6.78217 9.82158 6.6434 9.82158 6.49871Z" fill="#141414" />
                        <path d="M0.545876 5.95312H1.63704C1.78173 5.95312 1.9205 6.01061 2.02282 6.11292C2.12514 6.21524 2.18262 6.35401 2.18262 6.49871C2.18262 6.6434 2.12514 6.78217 2.02282 6.88449C1.9205 6.9868 1.78173 7.04429 1.63704 7.04429H0.545876C0.401179 7.04429 0.262408 6.9868 0.160092 6.88449C0.057776 6.78217 0.000295877 6.6434 0.000295877 6.49871C0.000295877 6.35401 0.057776 6.21524 0.160092 6.11292C0.262408 6.01061 0.401179 5.95312 0.545876 5.95312Z" fill="#141414" />
                        <path d="M9.47481 3.79761C9.37191 3.897 9.2341 3.95199 9.09105 3.95074C8.948 3.9495 8.81116 3.89212 8.71001 3.79097C8.60885 3.68981 8.55147 3.55298 8.55023 3.40993C8.54899 3.26688 8.60398 3.12906 8.70336 3.02616L9.47481 2.25471C9.57771 2.15533 9.71553 2.10034 9.85857 2.10158C10.0016 2.10283 10.1385 2.1602 10.2396 2.26136C10.3408 2.36251 10.3982 2.49935 10.3994 2.6424C10.4006 2.78545 10.3456 2.92327 10.2463 3.02616L9.47481 3.79761Z" fill="#141414" />
                        <path d="M2.53048 9.20003C2.63337 9.10064 2.77119 9.04565 2.91424 9.0469C3.05729 9.04814 3.19413 9.10552 3.29528 9.20667C3.39644 9.30783 3.45381 9.44466 3.45506 9.58771C3.4563 9.73076 3.40131 9.86858 3.30193 9.97148L2.53048 10.7429C2.42758 10.8423 2.28976 10.8973 2.14671 10.8961C2.00367 10.8948 1.86683 10.8374 1.76567 10.7363C1.66452 10.6351 1.60714 10.4983 1.6059 10.3552C1.60465 10.2122 1.65964 10.0744 1.75903 9.97148L2.53048 9.20003Z" fill="#141414" />
                        <path d="M2.91547 3.95747C2.77079 3.95744 2.63204 3.89994 2.52975 3.79761L1.7583 3.02616C1.65892 2.92327 1.60392 2.78545 1.60517 2.6424C1.60641 2.49935 1.66379 2.36251 1.76494 2.26136C1.8661 2.1602 2.00294 2.10283 2.14599 2.10158C2.28904 2.10034 2.42685 2.15533 2.52975 2.25471L3.3012 3.02616C3.37748 3.10246 3.42942 3.19967 3.45046 3.30548C3.4715 3.4113 3.4607 3.52098 3.41941 3.62066C3.37813 3.72034 3.30822 3.80553 3.21852 3.86549C3.12882 3.92544 3.02336 3.95745 2.91547 3.95747Z" fill="#141414" />
                        <path d="M9.4741 9.20003L10.2456 9.97148C10.2977 10.0218 10.3392 10.082 10.3678 10.1486C10.3964 10.2151 10.4115 10.2867 10.4121 10.3592C10.4127 10.4316 10.3989 10.5034 10.3715 10.5705C10.344 10.6375 10.3035 10.6985 10.2523 10.7497C10.2011 10.8009 10.1402 10.8414 10.0731 10.8689C10.0061 10.8963 9.93423 10.9101 9.86179 10.9095C9.78935 10.9088 9.71776 10.8938 9.65119 10.8652C9.58463 10.8366 9.52443 10.795 9.4741 10.7429L8.70265 9.97148C8.60327 9.86858 8.54828 9.73076 8.54952 9.58771C8.55076 9.44466 8.60814 9.30783 8.7093 9.20667C8.81045 9.10552 8.94729 9.04814 9.09034 9.0469C9.23339 9.04565 9.3712 9.10064 9.4741 9.20003Z" fill="#141414" />
                    </svg>
                ) : (
                    <svg width="13" height="13" viewBox="0 0 13 13" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M6.86201 1.46002C6.91038 1.43076 6.94737 1.38735 6.96736 1.33637C6.98735 1.28538 6.98926 1.22961 6.97279 1.17751C6.9566 1.12685 6.92388 1.08238 6.87932 1.05048C6.83477 1.01858 6.78068 1.0009 6.72485 1C5.69696 1.01307 4.69118 1.28474 3.81041 1.78721C2.92965 2.28969 2.20551 3.00493 1.7121 3.85976C1.21869 4.71458 0.973714 5.67832 1.00223 6.65235C1.03075 7.62638 1.33175 8.57575 1.87442 9.40332C2.41709 10.2309 3.18196 10.907 4.09077 11.3624C4.99959 11.8177 6.01972 12.0361 7.04679 11.9951C8.07387 11.9541 9.07103 11.6553 9.93624 11.1291C10.8014 10.6029 11.5037 9.86824 11.971 9.00036C11.9972 8.95189 12.006 8.89664 11.996 8.84302C11.986 8.78939 11.9579 8.74031 11.9158 8.70325C11.8737 8.66619 11.82 8.64316 11.7628 8.63767C11.7057 8.63218 11.6482 8.64453 11.5991 8.67284C10.5893 9.26961 9.37082 9.46171 8.21163 9.20688C7.05243 8.95205 6.04751 8.27118 5.41793 7.31403C4.78835 6.35689 4.58569 5.20189 4.85453 4.10311C5.12337 3.00433 5.84169 2.05178 6.85146 1.45502L6.86201 1.46002Z" stroke="#FFFFFF" strokeWidth="0.75" />
                    </svg>

                )}
            </motion.div>
        </button>
    );
}

const spring = {
    type: "spring",
    stiffness: 700,
    damping: 30
};